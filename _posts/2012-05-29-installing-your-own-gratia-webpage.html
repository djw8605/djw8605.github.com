---
title: Installing your own gratia webpage
date: '2012-05-29T15:33:00.002-05:00'
author: Derek Weitzel
tags:
- osg
modified_time: '2012-05-29T15:33:40.318-05:00'
thumbnail: http://3.bp.blogspot.com/-2n8e1tLk84k/T8UyiJZSdbI/AAAAAAAABbw/HCthke_8Tuc/s72-c/gratia_overview_shot.png
blogger_id: tag:blogger.com,1999:blog-3007054864987759910.post-5847705854552432796
blogger_orig_url: http://derekweitzel.blogspot.com/2012/05/installing-your-own-gratia-webpage.html
---

In the OSG, we use a technology called Gratia for our accounting. &nbsp;Every single job and data transfer on the OSG is accounted for in the database. &nbsp;Of course, this is a lot of data, ~500,000 jobs and 1.2M transfers just today. &nbsp;Therefore, we have a simple <a href="http://gratiaweb.grid.iu.edu/gratia/">web interface</a> to visualize this data.<br /><br />Here's the quick instructions of how I setup my own version of it:<br /><br /><ol><li>Install a newer version of python-cherrypy from rpmforge. &nbsp;EPEL version is not new enough. <br /><pre>rpm -Uvh http://rpms.arrfab.net/rpmforge/packages/python-cherrypy/python-cherrypy-3.1.2-1.el5.rf.noarch.rpm </pre></li><li>Install the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/YumRepositories">OSG repos</a>.</li><li>Install the Metrics RPM:<br /><pre>yum install OSG-Measurements-Metrics-Web -y</pre></li><li>Copy&nbsp;/etc/DBParam.xml.rpmnew to&nbsp;/etc/DBParam.xml <br /><pre>cp /etc/DBParam.xml.rpmnew /etc/DBParam.xml </pre></li><li>Now, you can edit DBParam.xml file to point to your own gratia databases. &nbsp;For example, at Nebraska, we have an instance that points to our own Nebraska gratia server. &nbsp;This way we can see only local usage. &nbsp;To use the OSG's, you will need to use the readonly account. &nbsp;Replace all of the ******'s with 'reader'. &nbsp;In VIM, you can do:<br /><pre>:%s/\*\*\*\*\*\*/reader/g</pre></li><li>The website relies on a set of static graphs that are updated every few hours. &nbsp;They have to be saved and served by the systems http server. &nbsp;So install the http server:<br /><pre>yum -y install httpd</pre></li><li>Make the directory for the static graphs to be saved into:<br /><pre>mkdir -p /var/www/html/gratiastatic</pre></li><li>Configure the static graph generator to put the images in this directory, and to generate the images from the gratia instance. &nbsp;You will need to change both the <span style="font-family: 'Courier New', Courier, monospace;">Source</span> and <span style="font-family: 'Courier New', Courier, monospace;">Dest</span>. &nbsp;The configuration is in /etc/osg_graphs.conf: <br /><script src="https://gist.github.com/2830498.js">  </script></li><li>Change the static graphs location in the DBParam.xml:<br /><pre>&lt;staticfilehostname value="http://10.148.2.148/gratiastatic"&gt; &lt;/staticfilehostname&gt;</pre></li><li>Start the services:<br /><pre>service httpd start</pre><pre>service GratiaWeb start</pre></li></ol>Then, you should have a functioning gratia web instance. <br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-2n8e1tLk84k/T8UyiJZSdbI/AAAAAAAABbw/HCthke_8Tuc/s1600/gratia_overview_shot.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="368" src="http://3.bp.blogspot.com/-2n8e1tLk84k/T8UyiJZSdbI/AAAAAAAABbw/HCthke_8Tuc/s640/gratia_overview_shot.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Running private instance of gratia web</td></tr></tbody></table><br />
