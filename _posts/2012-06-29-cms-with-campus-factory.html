---
title: CMS with the Campus Factory
date: '2012-06-29T11:01:00.004-05:00'
author: Derek Weitzel
tags:
- CMS
- osg
- campus
modified_time: '2012-06-29T11:01:36.977-05:00'
thumbnail: http://2.bp.blogspot.com/-PwBArI3BVkw/T-3QL5KwxBI/AAAAAAAABks/nsMZbzyLLe0/s72-c/CHEPCGF.png
blogger_id: tag:blogger.com,1999:blog-3007054864987759910.post-7326521332408725614
blogger_orig_url: http://derekweitzel.blogspot.com/2012/06/cms-with-campus-factory.html
---

<div class="separator" style="clear: both; text-align: center;"><br /></div>The Campus Factory is usually used by small research groups to expand their available resources to those on the campus. &nbsp;Of course, that's not always easy for larger VO's, who tend to have more complicated software setups. &nbsp;This is where the combination of <a href="http://nd.edu/~ccl/software/parrot/">Parrot </a>and <a href="http://cernvm.cern.ch/portal/">CernVM-FS</a> comes in.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://cernvm.cern.ch/portal/img/fs-logo.png" imageanchor="1" style="margin-left: auto; margin-right: auto; text-align: center;"><img border="0" src="http://cernvm.cern.ch/portal/img/fs-logo.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><a href="http://cernvm.cern.ch/portal/filesystem">Source:&nbsp;http://cernvm.cern.ch/portal/filesystem</a></td></tr></tbody></table><br /><div>CernVM-FS is a HTTP based file system that serves many CERN based VOs software repositories. &nbsp;In our case, we used a CernVM-FS server hosted at the University of Wisconsin - Madison (<a href="http://www.hep.wisc.edu/cms/comp/ops/cvmfs.html">Docs</a>)</div><div><br /></div><div>Parrot is a program that will capture reads and writes from arbitrary executables and redirect them to remote resources. &nbsp;For our use, we will redirect reads from the local file system to reads from the CernVM-FS server at UW.</div><div><br /></div><div>Our T3, as usual, is over subscribed. &nbsp;Sending our T3 jobs out onto the grid, much like <a href="http://derekweitzel.blogspot.com/2011/04/overflowing-teir-2.html">overflowing Tier 2 jobs</a>, would significantly decrease the time to completion for our CMS users. &nbsp;But, our campus grid does not have CMS software available everywhere, therefore we must export the software to the jobs. &nbsp;For this, we use Parrot and CernVM-FS.</div><div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-PwBArI3BVkw/T-3QL5KwxBI/AAAAAAAABks/nsMZbzyLLe0/s1600/CHEPCGF.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="336" src="http://2.bp.blogspot.com/-PwBArI3BVkw/T-3QL5KwxBI/AAAAAAAABks/nsMZbzyLLe0/s640/CHEPCGF.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Pilot submission of BOSCO</td></tr></tbody></table><br /><br />The BOSCO system is depicted in the above graphic. &nbsp;First the user submit their job to their local Condor. &nbsp;This instance of Condor could be tied to local resources that also can run their jobs, but for this picture, we only show the BOSCO resources. &nbsp;The Factory periodically queries the user's Condor, and submits Pilot jobs to run the user's jobs. &nbsp;Once the pilots start on the remote system, they begin executing the users' jobs. &nbsp;The user does not have to specify any special requirements, nor use any special commands for this system to work.<br /><br />We used BOSCO to flock jobs from our T3 to our other campus resources. &nbsp;This process required no user interaction. &nbsp;Matter of fact, the user had no idea that her jobs where not running on the T3. &nbsp;This transparent interaction with the user is the primary goal of the Campus Factory design, and was clear in this experiment.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-BG7CO9mjWQ8/T-3QN_uKp2I/AAAAAAAABk0/Cuye0-LLyNM/s1600/CHEPTier-3Campus.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="273" src="http://3.bp.blogspot.com/-BG7CO9mjWQ8/T-3QN_uKp2I/AAAAAAAABk0/Cuye0-LLyNM/s400/CHEPTier-3Campus.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tier-3 Connection to the UNL Campus Grid</td></tr></tbody></table><br /><div>We hope to make this a production service in the future. &nbsp;In the meantime, this is being used as a prototype for what other Campuses can do with BOSCO.<br /><br /></div></div><div><span style="background-color: white;">Acknowledgments</span>: Dan Bradley and the ccTools team for the CernVM-FS integration with parrot. &nbsp;The AAA project for the file infrastructure to enable transparent data access. &nbsp;And&nbsp;Helena Malbouisson for allowing me to play with her jobs, sending them to other resources.</div><div>Modifications to campus factory configs can be found on <a href="https://github.com/djw8605/CVMFS-CampusFactory">github</a>.</div>
