---
title: 'The next step for Bosco: BoscoR'
date: '2013-07-05T09:00:00.000-05:00'
author: Derek Weitzel
tags:
- bosco
- osg
- campus
modified_time: '2013-07-05T18:42:05.891-05:00'
thumbnail: http://1.bp.blogspot.com/-qVZBGNQ88yw/UdT7Dc87-vI/AAAAAAAAB-U/yhdqjgh-sOE/s72-c/BoscoR-pic.png
blogger_id: tag:blogger.com,1999:blog-3007054864987759910.post-4355281182743711284
blogger_orig_url: http://derekweitzel.blogspot.com/2013/07/the-next-step-for-bosco-boscor.html
---

With the 1.1 release of Bosco in January, the Bosco team finally had a usable product for researchers. &nbsp;It didn't have the best usability, but it was a solid tool to build on. &nbsp;When planning the next release, 1.2, we determined that we would not include many new features and instead focus on usability. &nbsp;With that focus, we interviewed researchers and looked around at our&nbsp;colleagues&nbsp;to see how most researchers interacted with their data on a daily basis, which was not with Condor or Bosco. &nbsp;Researchers&nbsp;used applications such as Matlab, Galaxy, or R. &nbsp;After investigating the options, we determined that R would be a great first application to&nbsp;integrate&nbsp;with Bosco. &nbsp;It is open source, has a strong community, and most importantly, it is heavily used by the researchers around us.<br /><h3>The Initial Steps</h3><div>Our first step was to look at how people are submitting R to HTC resources now. &nbsp;The CHTC does a great job of <a href="http://chtc.cs.wisc.edu/MATLABandR.shtml">submitting</a> entire R scripts for Wisconsin researchers. &nbsp;There is also <a href="http://diagrid.org/resources/58">SubmitR</a> from Hubzero which integrates a GUI with submission of R scripts. &nbsp;Both of these methods had good and bad attributes. &nbsp;</div><div><br /></div><div>The CHTC method was very easy to submit complex R scripts with many package dependencies to a very large number of nodes. &nbsp;But the researcher had to submit only on UW machines with the proper scripts installed. &nbsp;Also, the researcher still had to learn at least a minimal amount of HTCondor commands to successfully run their jobs. &nbsp;The researcher had to leave their environment and learn another, HTCondor.</div><div><br /></div><div>SubmitR, on the other hand, was very easy to use, with a graphical interface to upload and start jobs. &nbsp;SubmitR is open source, but deeply, deeply integrated with HubZero. &nbsp;Therefore, any submissions to SubmitR would need to be centralized to a small number of locations. &nbsp;Also, SubmitR had the same issue, the researcher had to leave their environment to learn another, in this case, HubZero and SubmitR.</div><div><br /></div><div>We found that the with Bosco installed on the researcher's laptop, we could leverage that locality to create a better interface. &nbsp;Our next step was to look a possible packages that could submit R jobs to clusters. &nbsp;They are listed on the HPC <a href="http://cran.r-project.org/web/views/HighPerformanceComputing.html">page</a> for R packages. &nbsp;The only package that fit our requirements, open source, released, and in <a href="http://cran.us.r-project.org/">CRAN</a> was <a href="http://cran.r-project.org/web/packages/GridR/">GridR</a>.</div><h3>Integrating Bosco with GridR</h3><div>When first looking at the source of GridR, it can be very intimidating. &nbsp;It is using asynchronous assignments to variables (which I would later learn is frowned upon in the R community). &nbsp;It submits jobs by forking a new processes to do the submission and monitor the jobs. &nbsp;Is uses R on the remote side to load the functions and variables to run the processing.</div><div><br /></div><div>Even though GridR is complicated, it has one great feature, everything is done from inside the R environment. &nbsp;The researcher simply loads a package and uses a familiar function, apply. &nbsp;With that function, the researcher can send a R function to a remote cluster to be processed, and the result will be written asynchronously back to the environment.</div><div><br /></div><div>When I began looking at modifying GridR, my first step was to find the source repository. &nbsp;Unfortunately, the package hasn't received an update since 2009, and the source repo was no where to be found. &nbsp; Luckily though, another researcher from Harvard had just modified GridR to submit to R jobs to a locally installed HTCondor cluster. &nbsp;By studying his changes, I was able to <a href="https://github.com/osg-bosco/GridR">fork</a> his work and add Bosco submission to GridR.</div><div><br /></div><div>The modifications to GridR where minimal. &nbsp;I needed to add a new submission type to package, bosco, and modify the local submit scripts with the Bosco submit settings. &nbsp;But GridR requires R to be installed on the remote cluster, so how is Bosco going to get R to the remote worker node before the job executes?</div><div><br /></div><div>Several different ideas where floated to install R on the remote worker node. &nbsp;We settled on a solution that used a bootstrap method. &nbsp;When the remote job started, instead of directly executing R, it would run a custom bootstrap script written for Bosco submissions. &nbsp;This bootstrap script would determine if R is already installed, and if not, it will download and install R either in the user's home directory or temporarily on the worker node for the duration of the job. &nbsp;This bootstraping enables GridR submission to successfully run anywhere with network access, whether it's on a campus cluster, or even national infrastructure, such as the OSG or XSEDE.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://bosco.opensciencegrid.org/boscor/"><img border="0" height="79" src="http://1.bp.blogspot.com/-qVZBGNQ88yw/UdT7Dc87-vI/AAAAAAAAB-U/yhdqjgh-sOE/s320/BoscoR-pic.png" width="320" /></a></div><div><h3>Current Status</h3></div><div>The first round of alpha testers have reported great success at running BoscoR. &nbsp;From installation to submission, all alpha testers were successful at running R jobs on remote clusters without any help from the Bosco developers. &nbsp;We also got much needed feedback from the R users on how the interface worked for them.</div><div><br /></div><div>The most common feedback was the use of the apply function for running multiple jobs. &nbsp;The testers are used to the apply function built into the R language, which runs a function once for every element in a list, then returns a list of results. &nbsp;GridR can do this, but it is not the default action of GridR's apply, therefore it provided an inconsistent interface with the rest of the R language. &nbsp;The Bosco team is working hard on this, and it will be fixed in the next BoscoR beta release out next week.</div><div><br /></div><div>The Bosco team has also submitted the updates to GridR for review by CRAN. &nbsp;Since GridR has not received an update since 2009, many policies have changed as to how packages can interact with the user's environment. &nbsp;As mentioned earlier, asynchronously modifying the user's environment, such as to set a variable to the result of a remotely execute function, is against CRAN policy. &nbsp;I am confident that this can be worked out, but it will take effort to include the updated GridR in CRAN, and it may take a while.</div><h3>Closing Thoughts</h3><div>Integrating with scientific applications and frameworks is the next step in Bosco to increase usability. &nbsp;Bosco cannot remain just a tool to be used, it must have interfaces built on top of it to connect with researchers, to reach out to them. &nbsp;The researchers do not want to leave their environment, and BoscoR provides them a way to stay in their comfort zone, all while completing their research at new levels.</div><h3>Getting BoscoR</h3><div>You can get BoscoR from the Bosco <a href="http://bosco.opensciencegrid.org/boscor/">website</a>.</div><div><br /></div><div><center><a href="http://bosco.opensciencegrid.org/download/">     <img alt="Bosco Download" src="https://raw.github.com/osg-bosco/bosco-download-images/master/images/download-orange.png" style="border-width: 0px;" /> </a>    </center></div>
