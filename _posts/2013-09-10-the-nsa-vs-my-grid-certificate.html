---
title: The NSA vs. my grid certificate
date: '2013-09-10T09:00:00.000-05:00'
author: Derek Weitzel
tags: 
modified_time: '2013-09-10T09:00:11.209-05:00'
thumbnail: http://4.bp.blogspot.com/-WflGwZXvIyQ/Ui4TPzTmRDI/AAAAAAAACDY/6SL1tBIS8PI/s72-c/Screen+Shot+2013-09-09+at+1.28.14+PM.png
blogger_id: tag:blogger.com,1999:blog-3007054864987759910.post-7972044838258291811
blogger_orig_url: http://derekweitzel.blogspot.com/2013/09/the-nsa-vs-my-grid-certificate.html
---

<b>Note: Opinions or statements made in this post are solely my own, and are not the opinions of any organization that I work with or for. &nbsp;Also, I probably got some details wrong... so there's that.</b><br /><br />Though I'm not all that concerned about the NSA decrypting my grid certificate, I am interested in how hard it would be. &nbsp;I want to be clear, I am by no stretch of the imagination a security specialist. &nbsp;But I find these kind of discussions interesting. &nbsp;If I say anything incorrect, please leave a comment so I may correct it.<br /><h3>Recent Events</h3><div>With much of the <a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html?pagewanted=all">recent</a> <a href="http://america.aljazeera.com/articles/2013/9/5/nsa-successfullycrackedencryptionreports.html">news</a> that the NSA can decrypt "secure" web traffic, I was curious if they could decrypt my grid traffic, though if they did, it would be quite boring.<br /><br />Yesterday I read a great <a href="http://blog.cryptographyengineering.com/2013/09/on-nsa.html">blog post</a> on the possible encryption indications from the perspective of a security researcher,&nbsp;<a class="profile-name-link g-profile" data-gapiattached="true" data-gapiscan="true" data-onload="true" href="http://www.blogger.com/profile/05041984203678598124" rel="author" style="background-color: white; background-image: url(http://www.blogger.com/img/logo-16.png); background-position: 0% 0%; background-repeat: no-repeat no-repeat; color: #4d469c; display: inline-block; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 14px; font-weight: bold; min-height: 20px; padding-left: 20px; text-decoration: none;">Matthew Green</a>. &nbsp;In his article, he gave 3 ways to attack the encryption:<br /><ol style="background-color: white; color: #444444; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 13px; line-height: 18px;"><li style="margin: 0px 0px 0.25em; padding: 0px;"><b>Attack the cryptography.</b>&nbsp;This&nbsp;is difficult and unlikely to work against the standard algorithms we use (though&nbsp;<a href="http://blog.cryptographyengineering.com/2013/03/attack-of-week-rc4-is-kind-of-broken-in.html" style="color: #4d469c; text-decoration: none;">there are exceptions</a>&nbsp;like RC4.) However there are many complex protocols in cryptography, and sometimes&nbsp;<a href="http://arstechnica.com/security/2013/02/lucky-thirteen-attack-snarfs-cookies-protected-by-ssl-encryption/" style="color: #4d469c; text-decoration: none;">they are vulnerable</a>.</li><li style="margin: 0px 0px 0.25em; padding: 0px;"><b>Go after the implementation.&nbsp;</b>Cryptography is almost always implemented in software -- and<a href="http://www.peereboom.us/assl/assl/html/openssl.html" style="color: #4d469c; text-decoration: none;">software is a&nbsp;<i>disaster</i></a>. Hardware isn't that much better. Unfortunately active software exploits only work if you have a target in mind. If your goal is mass surveillance, you need to build insecurity in from the start. That means working with vendors to add&nbsp;<a href="http://en.wikipedia.org/wiki/Backdoor_(computing)" style="color: #4d469c; text-decoration: none;">backdoors</a>.</li><li style="margin: 0px 0px 0.25em; padding: 0px;"><b>Access the human side</b>. Why hack someone's computer if you can get them to give you the key?</li></ol></div><div>Will this work on the grid?<br /><h3>Attacking the cryptography</h3>Grid security is based on Public Key Infrastructure (<a href="https://en.wikipedia.org/wiki/Public-key_infrastructure">wikipedia</a>). &nbsp;Each user is issued a Certificate which is then broken into a public key and a private key. &nbsp;Below is a picture of my Mac's keychain view of my certificate:</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-WflGwZXvIyQ/Ui4TPzTmRDI/AAAAAAAACDY/6SL1tBIS8PI/s1600/Screen+Shot+2013-09-09+at+1.28.14+PM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-WflGwZXvIyQ/Ui4TPzTmRDI/AAAAAAAACDY/6SL1tBIS8PI/s400/Screen+Shot+2013-09-09+at+1.28.14+PM.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">My Certificate</td></tr></tbody></table><div>There are several attributes listed here, but you can see that the key size is 2048 bits. &nbsp;For the RSA algorithm, the largest key publicly factored correctly has been 768 bits (<a href="https://en.wikipedia.org/wiki/RSA_Factoring_Challenge">wiki</a>). &nbsp;It took hundreds of computers months to do so. &nbsp;The NIST and the NSA lists 2048 bit encryption to be the standard for Federal computers until ~2030 (<a href="http://www.keylength.com/en/4/">source</a>), therefore, one can hopefully presume that they provide reasonable security for the time being.<br /><h3>Going after the implementation</h3></div><div>Most grid software are use the OpenSSL library to validate certificates. &nbsp;Lets assume that OpenSSL is acceptable (Matthew makes the argument that it may not be), grid software is not known for it's robustness. &nbsp;It is not difficult to imagine that there are unknown security vulnerabilities in the grid software. &nbsp;In the OSG, the 'gatekeeper' software that validates and authorizes users are no less then:</div><div><ul><li>Globus Gatekeeper (uses various libraries underneath, eventually OpenSSL)</li><li>Bestman</li><li>Gridftp (globus libraries)</li><li>XrootD</li><li>HTCondor</li><li>...</li></ul>It may be that not all of these software packages have vulnerabilities, maybe they are all perfect. &nbsp;But it is unlikely, as Matthew says:&nbsp;<a href="http://www.peereboom.us/assl/assl/html/openssl.html" style="background-color: white; color: #4d469c; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 13px; line-height: 18px; text-decoration: none;"><span style="color: #4d469c; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: x-small;"><span style="background-color: white; line-height: 18px;">software is a&nbsp;</span></span><i style="background-color: white; color: #4d469c; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 13px; line-height: 18px; text-decoration: none;">disaster</i></a>.</div><div><br /></div><div>Further, much of the communication in the Grid is authenticated, but not encrypted. &nbsp;For example, gridftp traffic, by default, is authenticated but not encrypted. &nbsp;Same with XrootD data, authenticated but not encrypted. &nbsp;This data could be easily gathered from anypoint along the network path.</div><h3>Access the human side</h3><div>The human side may be the easiest to manipulate. &nbsp;Until recently, the DOE issued all user and host certificates for the OSG. &nbsp;As the DOE is a federal agency, they may be more obligated to work with the NSA than a private company (conspiracy theory hat on). &nbsp;Recently a private company, DigiCert, has issued our certificates.</div><div><br /></div><div>Of course the NSA could ask the DOE or DigiCert to issue duplicate certificates and could do man-in-the-middle attacks. &nbsp;But as Matthew points out, it seems unlikely that the NSA would be interested in such a direct attack. &nbsp;The unencrypted data could be had so much easier from passive gathering.</div><div><br /></div><div>But, one has to wonder how many places my proxy is currently living, and how many administrative domains I am trusting, implicitly or explicitly. &nbsp;Just on the top of my head, I know my proxy is at:</div><div><ul><li>My Laptop</li><li>The HCC GlideinWMS VO frontend</li><li>The 3 OSG GlideinWMS factories</li><li>The 20+ Globus Gatekeepers that we submit to</li><li>Hundreds or possibly thousands of worker nodes across the U.S.</li></ul></div><h3>Should we get out our tin foil hats?</h3><div>Not just yet. &nbsp;It is unlikely that the NSA, or any state entities for that matter, would be interested in the scientific computing resources on a grid. &nbsp;Plenty of garden variety hackers would be interested in the computational power of the grid for bitcoin mining or botnets, but they are unlikely to have the resources to attack any of the above (except possibly the software). &nbsp;The Grid software has been hardened over time to these garden variety hackers, and I am somewhat confident that we can defend against them.</div><div><br /></div><div>So for the time being, the grid certificates appear to be safe from most threats. &nbsp;Personally, I'm more worried about the software.</div><div><br /></div>
